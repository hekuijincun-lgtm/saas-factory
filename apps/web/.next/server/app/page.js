(()=>{var e={};e.id=931,e.ids=[931],e.modules={2934:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external.js")},4580:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external.js")},5869:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external.js")},399:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},8434:(e,t,s)=>{"use strict";s.r(t),s.d(t,{GlobalError:()=>l.a,__next_app__:()=>m,originalPathname:()=>x,pages:()=>c,routeModule:()=>u,tree:()=>o}),s(4957),s(1595),s(8714);var r=s(3653),a=s(4966),n=s(6070),l=s.n(n),i=s(2555),d={};for(let e in i)0>["default","tree","pages","GlobalError","originalPathname","__next_app__","routeModule"].indexOf(e)&&(d[e]=()=>i[e]);s.d(t,d);let o=["",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(s.bind(s,4957)),"C:\\dev\\saas-factory\\apps\\web\\app\\page.tsx"]}]},{layout:[()=>Promise.resolve().then(s.bind(s,1595)),"C:\\dev\\saas-factory\\apps\\web\\app\\layout.tsx"],"not-found":[()=>Promise.resolve().then(s.t.bind(s,8714,23)),"next/dist/client/components/not-found-error"]}],c=["C:\\dev\\saas-factory\\apps\\web\\app\\page.tsx"],x="/page",m={require:s,loadChunk:()=>Promise.resolve()},u=new r.AppPageRouteModule({definition:{kind:a.x.APP_PAGE,page:"/page",pathname:"/",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:o}})},2986:(e,t,s)=>{Promise.resolve().then(s.bind(s,8566))},8566:(e,t,s)=>{"use strict";s.d(t,{default:()=>T});var r=s(2064),a=s(5032),n=s(9370),l=s(6608),i=s(8620),d=s(3373),o=s(1682),c=s(1236),x=s(8146),m=s(3721),u=s(7012),b=s(2153),p=s(1363),h=s(5773);let f=(0,h.Z)("Eye",[["path",{d:"M2.062 12.348a1 1 0 0 1 0-.696 10.75 10.75 0 0 1 19.876 0 1 1 0 0 1 0 .696 10.75 10.75 0 0 1-19.876 0",key:"1nclc0"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]);var j=s(8375);let g=(0,h.Z)("Download",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"7 10 12 15 17 10",key:"2ggqvy"}],["line",{x1:"12",x2:"12",y1:"15",y2:"3",key:"1vk2je"}]]),v=(0,h.Z)("RefreshCw",[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]]);function y(){let[e,t]=(0,a.useState)(!1),[s,n]=(0,a.useState)(""),[l,i]=(0,a.useState)(""),[d,o]=(0,a.useState)("all"),[h,y]=(0,a.useState)(""),[N,w]=(0,a.useState)([]),[k,C]=(0,a.useState)([]),[Z,M]=(0,a.useState)(!1),[S,P]=(0,a.useState)(null),[T,I]=(0,a.useState)(null),[_,D]=(0,a.useState)(null),[A,E]=(0,a.useState)(null),F=(0,a.useCallback)(async()=>{M(!0),P(null);try{let e=await (0,c.IF)(l);Array.isArray(e.reservations)?w(e.reservations):(console.warn("fetchReservations: response.reservations is not an array, setting to empty array"),w([]))}catch(e){P(e instanceof x.GY?e.message:e instanceof Error?e.message:"Failed to fetch reservations"),w([])}finally{M(!1)}},[l]),G=e=>{if(!A)return{canCancel:!0};let t=new Date(`${e.date}T${e.time}:00+09:00`),s=new Date,r=new Date(s.getTime()+6e4*s.getTimezoneOffset()+324e5);return(t.getTime()-r.getTime())/6e4<A.rules.cancelMinutes?{canCancel:!1,reason:`キャンセル期限（${A.rules.cancelMinutes}分前）を過ぎています`}:{canCancel:!0}},O=async e=>{let t=G(e);if(!t.canCancel){P(t.reason||"キャンセルできません");return}if(window.confirm(`予約をキャンセルしますか？
日付: ${e.date}
時間: ${e.time}
お名前: ${e.name}`)){I(e.reservationId);try{await (0,c.Ml)(e.reservationId),await F(),D(null)}catch(e){if(e instanceof x.GY&&404===e.status)await F(),D(null);else if(e instanceof x.GY&&409===e.status){let t=e.message||"";t.includes("already canceled")||t.includes("既にキャンセル")?(P("既にキャンセル済みです"),await F(),D(null)):P(e.message||"キャンセル期限を過ぎています")}else P(e instanceof x.GY?e.message:e instanceof Error?e.message:"Failed to cancel reservation")}finally{I(null)}}},$=e=>r.jsx(b.Z,{variant:"reserved",children:"予約済み"}),q=[{key:"time",label:"時刻",render:e=>r.jsx("span",{className:"font-medium text-brand-text",children:e.time})},{key:"name",label:"顧客",render:e=>(0,r.jsxs)("div",{children:[r.jsx("div",{className:"font-medium text-brand-text",children:e.name}),e.phone&&r.jsx("div",{className:"text-sm text-brand-muted",children:e.phone})]})},{key:"menu",label:"メニュー",render:()=>r.jsx("span",{className:"text-brand-muted",children:"-"})},{key:"staff",label:"担当",render:()=>r.jsx("span",{className:"text-brand-muted",children:"-"})},{key:"status",label:"ステータス",render:e=>$(e)},{key:"actions",label:"操作",render:e=>{let t=G(e);return(0,r.jsxs)("div",{className:"flex items-center gap-2",children:[r.jsx("button",{onClick:t=>{t.stopPropagation(),D(e)},className:"p-1.5 text-brand-muted hover:text-brand-primary hover:bg-brand-bg rounded-lg transition-all",title:"詳細",children:r.jsx(f,{className:"w-4 h-4"})}),r.jsx("button",{onClick:t=>{t.stopPropagation(),O(e)},disabled:T===e.reservationId||!t.canCancel,className:"p-1.5 text-rose-600 hover:text-rose-700 hover:bg-rose-50 rounded-lg transition-all disabled:opacity-50 disabled:cursor-not-allowed",title:t.reason||"キャンセル",children:r.jsx(j.Z,{className:"w-4 h-4"})})]})}}];return(0,r.jsxs)("div",{className:"space-y-6",children:[r.jsx(p.Z,{title:"予約管理",subtitle:"予約の一覧と管理を行います。",right:(0,r.jsxs)("div",{className:"flex items-center gap-2",children:[(0,r.jsxs)("button",{onClick:()=>{console.log("CSV export - TODO")},className:"px-4 py-2 text-sm font-medium text-brand-text bg-white border border-brand-border rounded-xl hover:shadow-md focus:outline-none focus:ring-2 focus:ring-brand-primary/20 focus:ring-offset-2 transition-all flex items-center gap-2",children:[r.jsx(g,{className:"w-4 h-4"}),"CSVエクスポート"]}),(0,r.jsxs)("button",{onClick:F,disabled:Z,className:"px-4 py-2 text-sm font-medium text-brand-text bg-white border border-brand-border rounded-xl hover:shadow-md focus:outline-none focus:ring-2 focus:ring-brand-primary/20 focus:ring-offset-2 disabled:opacity-50 disabled:cursor-not-allowed transition-all flex items-center gap-2",children:[r.jsx(v,{className:`w-4 h-4 ${Z?"animate-spin":""}`}),"更新"]})]})}),r.jsx(m.Z,{children:(0,r.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[(0,r.jsxs)("div",{children:[r.jsx("label",{htmlFor:"date",className:"block text-sm font-medium text-brand-text mb-2",children:"日付"}),r.jsx("input",{id:"date",type:"date",value:l,onChange:e=>i(e.target.value),className:"w-full px-4 py-3 border border-brand-border rounded-xl focus:outline-none focus:ring-2 focus:ring-brand-primary/20 focus:border-brand-primary transition-all"})]}),(0,r.jsxs)("div",{children:[r.jsx("label",{htmlFor:"status",className:"block text-sm font-medium text-brand-text mb-2",children:"ステータス"}),(0,r.jsxs)("div",{className:"relative",children:[(0,r.jsxs)("select",{id:"status",value:d,onChange:e=>o(e.target.value),disabled:!0,className:"w-full px-4 py-3 border border-brand-border rounded-xl focus:outline-none focus:ring-2 focus:ring-brand-primary/20 focus:border-brand-primary transition-all bg-white disabled:bg-brand-bg disabled:cursor-not-allowed disabled:opacity-60",children:[r.jsx("option",{value:"all",children:"すべて"}),r.jsx("option",{value:"reserved",children:"予約済み"}),r.jsx("option",{value:"completed",children:"完了"}),r.jsx("option",{value:"canceled",children:"キャンセル"})]}),r.jsx("span",{className:"absolute right-3 top-1/2 -translate-y-1/2 text-xs text-brand-muted",children:"準備中"})]}),r.jsx("p",{className:"mt-1 text-xs text-brand-muted",children:"ステータス機能は準備中です"})]}),(0,r.jsxs)("div",{children:[r.jsx("label",{htmlFor:"search",className:"block text-sm font-medium text-brand-text mb-2",children:"検索"}),r.jsx("input",{id:"search",type:"text",value:h,onChange:e=>y(e.target.value),placeholder:"顧客名・電話・予約ID",className:"w-full px-4 py-3 border border-brand-border rounded-xl focus:outline-none focus:ring-2 focus:ring-brand-primary/20 focus:border-brand-primary transition-all"})]})]})}),S&&r.jsx("div",{className:"p-4 bg-red-50 border border-red-200 rounded-2xl",children:r.jsx("p",{className:"text-sm text-red-700",children:S})}),r.jsx(m.Z,{children:r.jsx(u.Z,{columns:q,data:k,keyExtractor:e=>e.reservationId,loading:Z,emptyMessage:"予約がありません",onRowClick:e=>D(e)})}),_&&r.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4",onClick:()=>D(null),children:(0,r.jsxs)("div",{className:"bg-white rounded-2xl shadow-soft max-w-2xl w-full p-6 space-y-6",onClick:e=>e.stopPropagation(),children:[(0,r.jsxs)("div",{className:"flex items-start justify-between",children:[(0,r.jsxs)("div",{children:[r.jsx("h2",{className:"text-2xl font-semibold text-brand-text",children:"予約詳細"}),(0,r.jsxs)("p",{className:"text-sm text-brand-muted mt-1",children:["予約ID: ",_.reservationId]})]}),r.jsx("button",{onClick:()=>D(null),className:"p-2 text-brand-muted hover:text-brand-text hover:bg-brand-bg rounded-lg transition-all",children:r.jsx(j.Z,{className:"w-5 h-5"})})]}),(0,r.jsxs)("div",{className:"space-y-4",children:[(0,r.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,r.jsxs)("div",{children:[r.jsx("p",{className:"text-sm font-medium text-brand-muted mb-1",children:"日付"}),r.jsx("p",{className:"text-base text-brand-text",children:_.date})]}),(0,r.jsxs)("div",{children:[r.jsx("p",{className:"text-sm font-medium text-brand-muted mb-1",children:"時間"}),r.jsx("p",{className:"text-base text-brand-text",children:_.time})]})]}),(0,r.jsxs)("div",{children:[r.jsx("p",{className:"text-sm font-medium text-brand-muted mb-1",children:"お名前"}),r.jsx("p",{className:"text-base text-brand-text",children:_.name})]}),_.phone&&(0,r.jsxs)("div",{children:[r.jsx("p",{className:"text-sm font-medium text-brand-muted mb-1",children:"電話番号"}),r.jsx("p",{className:"text-base text-brand-text",children:_.phone})]}),(0,r.jsxs)("div",{children:[r.jsx("p",{className:"text-sm font-medium text-brand-muted mb-1",children:"作成日時"}),r.jsx("p",{className:"text-base text-brand-text",children:(t=>{if(!e)return t;try{return new Date(t).toLocaleString("ja-JP",{year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit"})}catch{return t}})(_.createdAt)})]}),(0,r.jsxs)("div",{children:[r.jsx("p",{className:"text-sm font-medium text-brand-muted mb-1",children:"ステータス"}),r.jsx("div",{children:$(_)})]})]}),r.jsx("div",{className:"flex items-center gap-2 pt-4 border-t border-brand-border",children:(()=>{let e=G(_);return(0,r.jsxs)(r.Fragment,{children:[r.jsx("button",{onClick:()=>{D(null),O(_)},disabled:T===_.reservationId||!e.canCancel,title:e.reason,className:"px-4 py-2 text-sm font-medium text-rose-600 bg-rose-50 border border-rose-200 rounded-xl hover:bg-rose-100 focus:outline-none focus:ring-2 focus:ring-rose-500/20 focus:ring-offset-2 disabled:opacity-50 disabled:cursor-not-allowed transition-all",children:T===_.reservationId?"キャンセル中...":"キャンセル"}),!e.canCancel&&e.reason&&r.jsx("p",{className:"text-xs text-rose-600 ml-2",children:e.reason})]})})()})]})})]})}s(2988);var N=s(5813),w=s(4872);let k=(0,h.Z)("Save",[["path",{d:"M15.2 3a2 2 0 0 1 1.4.6l3.8 3.8a2 2 0 0 1 .6 1.4V19a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2z",key:"1c8476"}],["path",{d:"M17 21v-7a1 1 0 0 0-1-1H8a1 1 0 0 0-1 1v7",key:"1ydtos"}],["path",{d:"M7 3v4a1 1 0 0 0 1 1h7",key:"t51u73"}]]),C=["日","月","火","水","木","金","土"];function Z(){let[e,t]=(0,a.useState)(null),[s,n]=(0,a.useState)(!1),[l,i]=(0,a.useState)(!1),[d,o]=(0,a.useState)(null),[u,b]=(0,a.useState)({openTime:"10:00",closeTime:"18:00",slotIntervalMin:60,closedWeekdays:[0],timezone:"Asia/Tokyo"}),h=async()=>{if(!/^\d{2}:\d{2}$/.test(u.openTime)){o("営業開始時間はHH:mm形式で入力してください");return}if(!/^\d{2}:\d{2}$/.test(u.closeTime)){o("営業終了時間はHH:mm形式で入力してください");return}if(u.slotIntervalMin<=0){o("時間枠間隔は1分以上である必要があります");return}i(!0),o(null);try{let e=await (0,c.VP)(u);t(e),o(null)}catch(e){o(e instanceof x.GY?e.message:e instanceof Error?e.message:"Failed to update settings")}finally{i(!1)}},f=e=>{b(t=>{let s=t.closedWeekdays.includes(e)?t.closedWeekdays.filter(t=>t!==e):[...t.closedWeekdays,e];return{...t,closedWeekdays:s}})};return s?(0,r.jsxs)("div",{className:"space-y-6",children:[r.jsx(p.Z,{title:"管理者設定",subtitle:"システム設定を変更します。"}),r.jsx(m.Z,{children:(0,r.jsxs)("div",{className:"flex items-center justify-center py-8",children:[r.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-brand-primary"}),r.jsx("span",{className:"ml-3 text-sm text-brand-muted",children:"読み込み中..."})]})})]}):(0,r.jsxs)("div",{className:"space-y-6",children:[r.jsx(p.Z,{title:"管理者設定",subtitle:"システム設定を変更します。",right:(0,r.jsxs)("button",{onClick:h,disabled:l,className:"px-4 py-2 bg-brand-primary text-white rounded-xl font-medium hover:shadow-md transition-all flex items-center gap-2 disabled:bg-brand-muted disabled:cursor-not-allowed",children:[r.jsx(k,{className:"w-5 h-5"}),r.jsx("span",{children:l?"保存中...":"保存"})]})}),d&&r.jsx("div",{className:"p-4 bg-red-50 border border-red-200 rounded-2xl",children:r.jsx("p",{className:"text-sm text-red-700",children:d})}),r.jsx(m.Z,{children:(0,r.jsxs)("div",{className:"space-y-6",children:[(0,r.jsxs)("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-brand-text mb-2",children:"営業開始時間 *"}),r.jsx("input",{type:"time",value:u.openTime,onChange:e=>b({...u,openTime:e.target.value}),className:"w-full px-4 py-3 border border-brand-border rounded-xl focus:outline-none focus:ring-2 focus:ring-brand-primary/20 focus:border-brand-primary"})]}),(0,r.jsxs)("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-brand-text mb-2",children:"営業終了時間 *"}),r.jsx("input",{type:"time",value:u.closeTime,onChange:e=>b({...u,closeTime:e.target.value}),className:"w-full px-4 py-3 border border-brand-border rounded-xl focus:outline-none focus:ring-2 focus:ring-brand-primary/20 focus:border-brand-primary"})]}),(0,r.jsxs)("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-brand-text mb-2",children:"時間枠間隔（分） *"}),r.jsx("input",{type:"number",value:u.slotIntervalMin,onChange:e=>b({...u,slotIntervalMin:parseInt(e.target.value)||60}),className:"w-full px-4 py-3 border border-brand-border rounded-xl focus:outline-none focus:ring-2 focus:ring-brand-primary/20 focus:border-brand-primary",min:"1"})]}),(0,r.jsxs)("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-brand-text mb-2",children:"定休日"}),r.jsx("div",{className:"flex flex-wrap gap-2",children:C.map((e,t)=>r.jsx("button",{onClick:()=>f(t),className:`px-4 py-2 rounded-xl border transition-all ${u.closedWeekdays.includes(t)?"bg-red-50 border-red-200 text-red-700":"bg-white border-brand-border text-brand-text hover:border-brand-primary"}`,children:e},t))})]}),(0,r.jsxs)("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-brand-text mb-2",children:"タイムゾーン"}),r.jsx("input",{type:"text",value:u.timezone,onChange:e=>b({...u,timezone:e.target.value}),className:"w-full px-4 py-3 border border-brand-border rounded-xl focus:outline-none focus:ring-2 focus:ring-brand-primary/20 focus:border-brand-primary",placeholder:"Asia/Tokyo"})]})]})})]})}let M={dashboard:{title:"ダッシュボード",subtitle:"今日の店舗状況のサマリーです。"},reservations:{title:"予約管理",subtitle:"予約の一覧と管理を行います。"},menus:{title:"メニュー管理",subtitle:"メニューの追加・編集を行います。"},staff:{title:"スタッフ管理",subtitle:"スタッフの追加・編集を行います。"},settings:{title:"管理者設定",subtitle:"システム設定を変更します。"}};function S(){let[e,t]=(0,a.useState)("dashboard"),s=M[e];return r.jsx(l.Z,{sidebar:r.jsx(d.Z,{activeTab:e,setTab:t}),topbar:r.jsx(i.Z,{title:s.title,subtitle:s.subtitle}),children:(()=>{switch(e){case"dashboard":return r.jsx(o.Z,{});case"reservations":return r.jsx(y,{});case"menus":return r.jsx(N.Z,{});case"staff":return r.jsx(w.Z,{});case"settings":return r.jsx(Z,{});default:return null}})()})}var P=s(4271);function T(){let[e,t]=(0,a.useState)("booking");return"admin"===e?r.jsx(S,{}):r.jsx(P.default,{children:r.jsx(n.default,{})})}},1682:(e,t,s)=>{"use strict";s.d(t,{Z:()=>l});var r=s(2064),a=s(3721),n=s(1363);function l(){return(0,r.jsxs)("div",{className:"space-y-6",children:[r.jsx(n.Z,{title:"ダッシュボード",subtitle:"今日の店舗状況のサマリーです。"}),(0,r.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:[r.jsx(a.Z,{children:(0,r.jsxs)("div",{className:"flex items-start justify-between",children:[(0,r.jsxs)("div",{className:"flex items-center gap-3",children:[r.jsx("div",{className:"w-12 h-12 bg-blue-50 rounded-lg flex items-center justify-center",children:r.jsx("span",{className:"text-2xl",children:"\uD83D\uDCC5"})}),(0,r.jsxs)("div",{children:[r.jsx("p",{className:"text-sm text-brand-muted mb-1",children:"本日の予約数"}),r.jsx("p",{className:"text-2xl font-semibold text-brand-text",children:"12"})]})]}),r.jsx("div",{className:"flex items-center gap-1 px-2 py-1 bg-green-50 rounded-md",children:r.jsx("span",{className:"text-xs font-medium text-green-700",children:"+20%"})})]})}),r.jsx(a.Z,{children:(0,r.jsxs)("div",{className:"flex items-start justify-between",children:[(0,r.jsxs)("div",{className:"flex items-center gap-3",children:[r.jsx("div",{className:"w-12 h-12 bg-green-50 rounded-lg flex items-center justify-center",children:r.jsx("span",{className:"text-2xl",children:"\uD83D\uDCB0"})}),(0,r.jsxs)("div",{children:[r.jsx("p",{className:"text-sm text-brand-muted mb-1",children:"売上見込み"}),r.jsx("p",{className:"text-2xl font-semibold text-brand-text",children:"\xa584,000"})]})]}),r.jsx("div",{className:"flex items-center gap-1 px-2 py-1 bg-green-50 rounded-md",children:r.jsx("span",{className:"text-xs font-medium text-green-700",children:"+5%"})})]})}),r.jsx(a.Z,{children:(0,r.jsxs)("div",{className:"flex items-start justify-between",children:[(0,r.jsxs)("div",{className:"flex items-center gap-3",children:[r.jsx("div",{className:"w-12 h-12 bg-purple-50 rounded-lg flex items-center justify-center",children:r.jsx("span",{className:"text-2xl",children:"⏰"})}),(0,r.jsxs)("div",{children:[r.jsx("p",{className:"text-sm text-brand-muted mb-1",children:"空き枠"}),r.jsx("p",{className:"text-2xl font-semibold text-brand-text",children:"8"})]})]}),r.jsx("div",{className:"flex items-center gap-1 px-2 py-1 bg-slate-50 rounded-md",children:r.jsx("span",{className:"text-xs font-medium text-slate-600",children:"-"})})]})})]})]})}},5813:(e,t,s)=>{"use strict";s.d(t,{Z:()=>b});var r=s(2064),a=s(5032),n=s(1236),l=s(8146),i=s(3721),d=s(1363),o=s(7012),c=s(2153),x=s(8048),m=s(8716),u=s(8375);function b(){let[e,t]=(0,a.useState)([]),[s,b]=(0,a.useState)(!1),[p,h]=(0,a.useState)(null),[f,j]=(0,a.useState)(!1),[g,v]=(0,a.useState)(null),[y,N]=(0,a.useState)({name:"",price:0,durationMin:60,active:!0,sortOrder:0}),w=async()=>{b(!0),h(null);try{let e=await (0,n.r7)();Array.isArray(e)?t(e):(console.warn("fetchMenu: menu is not an array, setting to empty array"),t([]))}catch(e){h(e instanceof l.GY?e.message:e instanceof Error?e.message:"Failed to fetch menu"),t([])}finally{b(!1)}},k=e=>{v(e),N({name:e.name,price:e.price,durationMin:e.durationMin,active:e.active,sortOrder:e.sortOrder}),j(!0)},C=async()=>{if(!y.name.trim()){h("メニュー名は必須です");return}if(y.price<0){h("価格は0以上である必要があります");return}if(y.durationMin<=0){h("所要時間は1分以上である必要があります");return}b(!0),h(null);try{g?await (0,n.Uf)(g.id,{name:y.name.trim(),price:y.price,durationMin:y.durationMin,active:y.active,sortOrder:y.sortOrder}):await (0,n.LW)({name:y.name.trim(),price:y.price,durationMin:y.durationMin,active:y.active,sortOrder:y.sortOrder}),await w(),j(!1)}catch(e){h(e instanceof l.GY?e.message:e instanceof Error?e.message:"Failed to save menu item")}finally{b(!1)}},Z=async e=>{b(!0),h(null);try{await (0,n.Uf)(e.id,{active:!e.active}),await w()}catch(e){h(e instanceof l.GY?e.message:e instanceof Error?e.message:"Failed to update menu item")}finally{b(!1)}};return(0,r.jsxs)("div",{className:"space-y-6",children:[r.jsx(d.Z,{title:"メニュー管理",subtitle:"メニューの追加・編集を行います。",right:(0,r.jsxs)("button",{onClick:()=>{v(null),N({name:"",price:0,durationMin:60,active:!0,sortOrder:e.length}),j(!0)},className:"px-4 py-2 bg-brand-primary text-white rounded-xl font-medium hover:shadow-md transition-all flex items-center gap-2",children:[r.jsx(x.Z,{className:"w-5 h-5"}),r.jsx("span",{children:"追加"})]})}),p&&r.jsx("div",{className:"p-4 bg-red-50 border border-red-200 rounded-2xl",children:r.jsx("p",{className:"text-sm text-red-700",children:p})}),r.jsx(i.Z,{children:s&&0===e.length?(0,r.jsxs)("div",{className:"flex items-center justify-center py-8",children:[r.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-brand-primary"}),r.jsx("span",{className:"ml-3 text-sm text-brand-muted",children:"読み込み中..."})]}):r.jsx(o.Z,{headers:["メニュー名","価格","所要時間","状態","操作"],rows:e.map(e=>[e.name,`\xa5${e.price.toLocaleString()}`,`${e.durationMin}分`,r.jsx(c.Z,{variant:e.active?"success":"muted",children:e.active?"有効":"無効"},"status"),(0,r.jsxs)("div",{className:"flex items-center gap-2",children:[r.jsx("button",{onClick:()=>k(e),className:"p-2 text-brand-primary hover:bg-brand-bg rounded-lg transition-all",title:"編集",children:r.jsx(m.Z,{className:"w-4 h-4"})}),r.jsx("button",{onClick:()=>Z(e),className:"p-2 text-brand-muted hover:bg-brand-bg rounded-lg transition-all",title:e.active?"無効化":"有効化",children:r.jsx(u.Z,{className:"w-4 h-4"})})]},"actions")])})}),f&&r.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4",onClick:()=>j(!1),children:(0,r.jsxs)("div",{className:"bg-white rounded-2xl shadow-soft max-w-md w-full p-6 space-y-4",onClick:e=>e.stopPropagation(),children:[r.jsx("h2",{className:"text-xl font-semibold text-brand-text",children:g?"メニューを編集":"メニューを追加"}),(0,r.jsxs)("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-brand-text mb-2",children:"メニュー名 *"}),r.jsx("input",{type:"text",value:y.name,onChange:e=>N({...y,name:e.target.value}),className:"w-full px-4 py-3 border border-brand-border rounded-xl focus:outline-none focus:ring-2 focus:ring-brand-primary/20 focus:border-brand-primary",placeholder:"メニュー名"})]}),(0,r.jsxs)("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-brand-text mb-2",children:"価格 *"}),r.jsx("input",{type:"number",value:y.price,onChange:e=>N({...y,price:parseInt(e.target.value)||0}),className:"w-full px-4 py-3 border border-brand-border rounded-xl focus:outline-none focus:ring-2 focus:ring-brand-primary/20 focus:border-brand-primary",min:"0",placeholder:"0"})]}),(0,r.jsxs)("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-brand-text mb-2",children:"所要時間（分） *"}),r.jsx("input",{type:"number",value:y.durationMin,onChange:e=>N({...y,durationMin:parseInt(e.target.value)||60}),className:"w-full px-4 py-3 border border-brand-border rounded-xl focus:outline-none focus:ring-2 focus:ring-brand-primary/20 focus:border-brand-primary",min:"1",placeholder:"60"})]}),(0,r.jsxs)("div",{className:"flex items-center gap-2",children:[r.jsx("input",{type:"checkbox",id:"active",checked:y.active,onChange:e=>N({...y,active:e.target.checked}),className:"w-4 h-4 text-brand-primary border-brand-border rounded focus:ring-brand-primary"}),r.jsx("label",{htmlFor:"active",className:"text-sm text-brand-text",children:"有効"})]}),(0,r.jsxs)("div",{className:"flex gap-2 pt-4",children:[r.jsx("button",{onClick:()=>j(!1),className:"flex-1 px-4 py-3 bg-white text-brand-text border border-brand-border rounded-xl font-medium hover:shadow-md transition-all",children:"キャンセル"}),r.jsx("button",{onClick:C,disabled:s||!y.name.trim(),className:"flex-1 px-4 py-3 bg-brand-primary text-white rounded-xl font-medium hover:shadow-md focus:outline-none focus:ring-2 focus:ring-brand-primary focus:ring-offset-2 disabled:bg-brand-muted disabled:cursor-not-allowed transition-all",children:s?"保存中...":"保存"})]})]})})]})}},4957:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>n});var r=s(9222);let a=(0,s(1924).createProxy)(String.raw`C:\dev\saas-factory\apps\web\app\_components\BookingApp.tsx#default`);function n(){return r.jsx(a,{})}}};var t=require("../webpack-runtime.js");t.C(e);var s=e=>t(t.s=e),r=t.X(0,[352,494,937,770,872,573],()=>s(8434));module.exports=r})();